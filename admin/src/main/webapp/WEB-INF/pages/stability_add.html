<!DOCTYPE html>
<!--
BeyondAdmin - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.2.0
Version: 1.0.0
Purchase: http://wrapbootstrap.com
-->

<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Head -->
<head>
  <meta charset="utf-8" />
  <title>能力验证评定统计分析系统</title>

  <meta name="description" content="Bootstrap Grid System" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="shortcut icon" href="assets/img/favicon.png" type="image/x-icon">
  <!--JEXCEL JS AND CSS-->
  <script src="dist/js/jquery.min.js"></script>
  <script src="dist/js/jquery.jexcel.js"></script>
  <script src="dist/js/jquery.jcalendar.js"></script>
  <link rel="stylesheet" href="dist/css/jquery.jexcel.css" type="text/css" />
  <link rel="stylesheet" href="dist/css/jquery.jcalendar.css" type="text/css" />
  <!--Basic Styles-->
  <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
  <link id="bootstrap-rtl-link" href="" rel="stylesheet" />
  <link href="assets/css/font-awesome.min.css" rel="stylesheet" />
  <link href="assets/css/weather-icons.min.css" rel="stylesheet" />
  <!--Fonts-->
  <!--Beyond styles-->
  <link id="beyond-link" href="assets/css/beyond.min.css" rel="stylesheet" />
  <link href="assets/css/demo.min.css" rel="stylesheet" />
  <link href="assets/css/typicons.min.css" rel="stylesheet" />
  <link href="assets/css/animate.min.css" rel="stylesheet" />
  <link id="skin-link" href="" rel="stylesheet" type="text/css" />
  <!--Skin Script: Place this script in head to load scripts for skins and rtl support-->
  <script src="assets/js/skins.min.js"></script>
  <script type="text/javascript">
  $(document).ready(function(){

  });
  </script>
</head>
<!-- /Head -->
<!-- Body -->
<body>
  <!-- Loading Container -->

  <!--  /Loading Container -->
  <!-- Navbar -->
  <div class="navbar">
    <div class="navbar-inner">
      <div class="navbar-container">
        <!-- Navbar Barnd -->
        <div class="navbar-header pull-left">
          <a href="#" class="navbar-brand">
            <small>
              <img src="assets/img/logo.png" alt="" />
            </small>
          </a>
        </div>
        <!-- /Navbar Barnd -->
        <!-- Sidebar Collapse -->
        <div class="sidebar-collapse" id="sidebar-collapse">
          <i class="collapse-icon fa fa-bars"></i>
        </div>
        <!-- /Sidebar Collapse -->
      </div>
    </div>
  </div>
  <!-- /Navbar -->
  <!-- Main Container -->
  <div class="main-container container-fluid">
    <!-- Page Container -->
    <div class="page-container">
      <!-- Page Sidebar -->
      <div class="page-sidebar" id="sidebar">
        <!-- Sidebar Menu -->
        <ul class="nav sidebar-menu">
          <!--Dashboard-->
          <li>
            <a href="grid.jhtml">
              <i class="menu-icon glyphicon glyphicon-home"></i>
              <span class="menu-text"> 能力评定列表 </span>
            </a>
          </li>
          <!--Databoxes-->
          <li class="active open">
            <a href="#" class="menu-dropdown">
              <i class="menu-icon glyphicon glyphicon-tasks"></i>
              <span class="menu-text"> 均匀性与稳定性检验 </span>
              <i class="menu-expand"></i>
            </a>
            <ul class="submenu">
                <li ><a href="homogeneity.jhtml">均匀性检验</a></li>
                <li class="active"><a href="stability.jhtml">稳定性检验</a></li>
            </ul>
          </li>
          <!--Widgets-->

        </ul>
        <!-- /Sidebar Menu -->
      </div>
      <!-- /Page Sidebar -->
      <!-- Page Content -->
      <div class="page-content">
        <!-- Page Breadcrumb -->
        <div class="page-breadcrumbs">
          <ul class="breadcrumb">
            <li>
              <i class="fa fa-home"></i>
              <a href="#">首页</a>
            </li>
            <li>稳定性与均匀性检验 </li>
            <li>稳定性检验</li>
          </ul>
        </div>
        <!-- /Page Breadcrumb -->
        <!-- Page Header -->
        <div class="page-header position-relative">
          <div class="header-title">
            <h1>
              稳定性检验
            </h1>
          </div>
          <!--Header Buttons-->
          <div class="header-buttons">
            <a class="sidebar-toggler" href="#">
              <i class="fa fa-arrows-h"></i>
            </a>
            <a class="refresh" id="refresh-toggler" href="">
              <i class="glyphicon glyphicon-refresh"></i>
            </a>
            <a class="fullscreen" id="fullscreen-toggler" href="#">
              <i class="glyphicon glyphicon-fullscreen"></i>
            </a>
          </div>
          <!--Header Buttons End-->
        </div>
        <!-- /Page Header -->
        <!-- Page Body -->
        <div class="page-body">
          <div class="row">
            <div class="col-xs-12 col-md-12">
              <div class="widget">
                <div class="widget-body" >
                  <button class="btn btn-success shiny" style="margin-top:10px;margin-left:10px;" id="btn_datainput" data-toggle="modal" data-target=".bs-example-modal-lg">导入数据</button>
                  <br />
                  <br />
                  <table class="table table-bordered table-hover table-striped" id="homogeneitytable">
                    <thead class="bordered-darkorange">
                      <tr role="row">
                        <th>样品编号</th>
                        <th>被测量</th>
                        <th style="width:90px">单位</th>
                        <th>中位数</th>
                        <th>标准差</th>
                        <th>δ<sub>E</sub></th>
                        <th>σ<sub>pt</sub></th>
                        <th>结果1</th>
                        <th>t检验法（与标准值/参考值比较）</th>
                        <th>t检验法（两个均值的比较）</th>
                        <th>操作</th>
                      </tr>
                    </thead>
                    <tbody>
                    <tr>
                      <td id="sampleNo"></td>
                      <td id="variable"></td>
                      <td id="unit"></td>
                      <td id="median"></td>
                      <td id="stderr"></td>
                      <td><input  type="text" id="e_1"/></td>
                      <td><input  type="text" id="pt_1"/></td>
                      <td id="singleFactory"></td>
                      <td id="sscc"></td>
                      <td id="extension"></td>
                      <td>
                        <a href="javascript:calculate();" class="btn btn-info btn-xs save"><i class="fa fa-save"></i> 计算</a>
                      </td>
                    </tr>
                    </tbody>
                  </table>
                </div>

              </div>
            </div>
          </div>

          <!-- /Page Body -->
        </div>

        <!-- /Page Content -->
      </div>
      <!-- /Page Container -->
      <!-- Main Container -->
      <!--LArge Modal Templates-->
      <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">

            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
              <h4 class="modal-title" id="myLargeModalLabel">导入实验室检测数据</h4>
            </div>
            <div class="modal-body" id="my">

            </div>
            <div style="margin-left:20%;margin-bottom:4px">
              <button id="btn_save" onclick="getdata()" class="btn btn-primary shiny" data-dismiss="modal" aria-hidden="true">保存</button>

            </div>
          </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
      </div>
    </div>

    <!--Basic Scripts-->

    <script src="assets/js/bootstrap.min.js"></script>

    <!--Beyond Scripts-->
    <script src="assets/js/beyond.min.js"></script>
    <script>
    data = [
            ['1','10111','2018-1-12','\t维生素B6;维生素B2','mg/100g','2.2345',''],
        ];
    $('#my').jexcel({
      data:data,
      colHeaders: [ '测量份样','样品编号','测量日期','被测量','单位','测量值1','测量值2'],
      colWidths: [ 60, 100,120,170,70,150,150 ],
      minDimensions:[7,10],
      columns: [
        { type: 'text' },
        { type: 'text'},
      ]
    });

    var data;
    var input;

    function getdata(){
        data = $('#my').jexcel('getData');
        input = dealArray(input,5,7);
        $.post("statistical/calStatistics2.jhtml", {
            "input": JSON.stringify(input)
        }, function (result) {
            if (result.status != 200) {
                return layer.msg(result.message),!1;
            } else {
                $('#sampleNo').html(data[0][1])
                $('#variable').html(data[0][3])
                $('#unit').html(data[0][4])
                $('#median').html(result.median)
                $('#stderr').html(result.standardVar)
                return layer.msg("计算完成"),!1;
            }
        }, "json");
    };

    function calculate(){
        var load = layer.load();
        var std =$("#pt_1").val();
        $.post("statistical/checkStability2.jhtml", {
            "input": JSON.stringify(input),"para":std,
        }, function (result) {
            if (result.status != 200) {
                return layer.msg(result.message),!1;
            } else {
                layer.close(load)
                $('#singleFactory').html(result.singleFactory)
                $('#extension').html(result.extension)
                return layer.msg("计算完成"),!1;
            }
        }, "json");
    }

    function dealArray(input,start,end){
        len = input.length
        for(var i=0;i<len;i++){
            input[i] = input[i].slice(start,end)
        }
        return input;
    }

    </script>
  </body>
  <!--  /Body -->
  </html>
